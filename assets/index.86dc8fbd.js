import f from"https://unpkg.com/@mapbox/mapbox-gl-draw@1.3.0/src/lib/theme.js";(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))i(o);new MutationObserver(o=>{for(const n of o)if(n.type==="childList")for(const p of n.addedNodes)p.tagName==="LINK"&&p.rel==="modulepreload"&&i(p)}).observe(document,{childList:!0,subtree:!0});function r(o){const n={};return o.integrity&&(n.integrity=o.integrity),o.referrerpolicy&&(n.referrerPolicy=o.referrerpolicy),o.crossorigin==="use-credentials"?n.credentials="include":o.crossorigin==="anonymous"?n.credentials="omit":n.credentials="same-origin",n}function i(o){if(o.ep)return;o.ep=!0;const n=r(o);fetch(o.href,n)}})();const g={enable(e){setTimeout(()=>{!e.map||!e.map.doubleClickZoom||!e._ctx||!e._ctx.store||!e._ctx.store.getInitialConfigValue||!e._ctx.store.getInitialConfigValue("doubleClickZoom")||e.map.doubleClickZoom.enable()},0)},disable(e){setTimeout(()=>{!e.map||!e.map.doubleClickZoom||e.map.doubleClickZoom.disable()},0)}},h={ADD:"add",MOVE:"move",DRAG:"drag",POINTER:"pointer",NONE:"none"};function y(e){return e.keyCode===27}const c="select_feature",d=`${c}_highlight`,I={highlightColor:"#222"},s={};s.onSetup=function(e){const{selectHighlightColor:t,onSelect:r,onCancel:i}=e,o={};o.hoveredFeatureID=null,o.selectedFeatureID=null,o.onSelect=r,o.onCancel=i,o.api=this._ctx.api;const{selectHighlightColor:n=I.highlightColor}=this._ctx.options;return o.options={selectHighlightColor:t||n},o};s.onMouseMove=function(e,t){const{api:r}=e,{featureTarget:i}=t;if(i){this.updateUIClasses({mouse:h.POINTER});const o=i.properties.id;e.hoveredFeatureID!==null&&e.hoveredFeatureID!==o&&r.setFeatureProperty(e.hoveredFeatureID,d,void 0),e.hoveredFeatureID=o,r.setFeatureProperty(e.hoveredFeatureID,d,e.options.selectHighlightColor)}else e.hoveredFeatureID&&r.setFeatureProperty(e.hoveredFeatureID,d,void 0),e.hoveredFeatureID=null};s.onClick=function(e,t){e.selectedFeatureID=e.hoveredFeatureID,this.onStop(e,t)};s.toDisplayFeatures=function(e,t,r){r(t)};s.onKeyUp=function(e,t){y(t)&&typeof e.onCancel=="function"&&setTimeout(e.onCancel,0)};s.onStop=function(e){this.updateUIClasses({mouse:h.NONE}),g.enable(this),this.activateUIButton(),e.selectedFeatureID?(typeof e.onSelect=="function"?setTimeout(e.onSelect.bind(null,e.selectedFeatureID),0):this.map.fire("draw.select_mode.select",{featureID:e.selectedFeatureID}),e.selectedFeatureID=null):typeof e.onCancel=="function"&&setTimeout(e.onCancel,0),e.hoveredFeatureID&&(this._ctx.api.setFeatureProperty(e.hoveredFeatureID,d,void 0),e.hoveredFeatureID=null)};const l=`user_${d}`,D=e=>e.concat([{id:`${c}-fill`,type:"fill",filter:["all",["==","$type","Polygon"],["has",l]],paint:{"fill-color":["get",l],"fill-outline-color":["get",l],"fill-opacity":.2}},{id:`${c}-stroke`,type:"line",filter:["all",["==","$type","Polygon"],["has",l]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":["get",l],"line-dasharray":[.2,2],"line-width":2}},{id:`${c}-line`,type:"line",filter:["all",["==","$type","LineString"],["has",l]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":["get",l],"line-dasharray":[.2,2],"line-width":2}},{id:`${c}-point`,type:"circle",filter:["all",["==","$type","Point"],["has",l]],paint:{"circle-color":["get",l],"circle-radius":3}}]);function C(e){return{...e,[c]:s}}let u,a,m;const b=()=>{try{a==null||a.changeMode("select_feature",{onSelect(e){alert(`Selected Feature ID: ${e}`)}})}catch(e){alert(e.message),console.error(e)}};class M{constructor(t){let r=this;r.draw=t.draw,r.buttons=t.buttons||[],r.onAddOrig=t.draw.onAdd,r.onRemoveOrig=t.draw.onRemove}onAdd(t){let r=this;return r.map=t,r.elContainer=r.onAddOrig(t),r.buttons.forEach(i=>{r.addButton(i)}),r.elContainer}onRemove(t){let r=this;r.buttons.forEach(i=>{r.removeButton(i)}),r.onRemoveOrig(t)}addButton(t){let r=this;var i=document.createElement("button");i.className="mapbox-gl-draw_ctrl-draw-btn",t.classes instanceof Array&&t.classes.forEach(o=>{i.classList.add(o)}),i.addEventListener(t.on,t.action),r.elContainer.appendChild(i),t.elButton=i}removeButton(t){t.elButton.removeEventListener(t.on,t.action),t.elButton.remove()}}mapboxgl.getRTLTextPluginStatus()==="unavailable"&&mapboxgl.setRTLTextPlugin("https://api.mapbox.com/mapbox-gl-js/plugins/mapbox-gl-rtl-text/v0.2.3/mapbox-gl-rtl-text.js",e=>{e&&console.error(e)},!0);u=new mapboxgl.Map({container:"map",style:"https://map.ir/vector/styles/main/mapir-xyz-light-style.json",center:[51.3857,35.6102],zoom:7.78,pitch:0,interactive:!0,hash:!0,attributionControl:!0,customAttribution:"\xA9 Map \xA9 Openstreetmap",transformRequest:e=>({url:e,headers:{"x-api-key":"eyJ0eXAiOiJKV1QiLCJhbGciOiJSUzI1NiIsImp0aSI6ImRiZWU0YWU4OTk4OTA3MmQ3OTFmMjQ4ZDE5N2VhZTgwZWU2NTUyYjhlYjczOWI2NDdlY2YyYzIzNWRiYThiMzIzOTM5MDkzZDM0NTY2MmU3In0.eyJhdWQiOiI5NDMyIiwianRpIjoiZGJlZTRhZTg5OTg5MDcyZDc5MWYyNDhkMTk3ZWFlODBlZTY1NTJiOGViNzM5YjY0N2VjZjJjMjM1ZGJhOGIzMjM5MzkwOTNkMzQ1NjYyZTciLCJpYXQiOjE1OTA4MjU0NzIsIm5iZiI6MTU5MDgyNTQ3MiwiZXhwIjoxNTkzNDE3NDcyLCJzdWIiOiIiLCJzY29wZXMiOlsiYmFzaWMiXX0.M_z4xJlJRuYrh8RFe9UrW89Y_XBzpPth4yk3hlT-goBm8o3x8DGCrSqgskFfmJTUD2wC2qSoVZzQKB67sm-swtD5fkxZO7C0lBCMAU92IYZwCdYehIOtZbP5L1Lfg3C6pxd0r7gQOdzcAZj9TStnKBQPK3jSvzkiHIQhb6I0sViOS_8JceSNs9ZlVelQ3gs77xM2ksWDM6vmqIndzsS-5hUd-9qdRDTLHnhdbS4_UBwNDza47Iqd5vZkBgmQ_oDZ7dVyBuMHiQFg28V6zhtsf3fijP0UhePCj4GM89g3tzYBOmuapVBobbX395FWpnNC3bYg7zDaVHcllSUYDjGc1A","Mapir-SDK":"reactjs"}})});a=new MapboxDraw({modes:{...C(MapboxDraw.modes)},styles:[...D(f)],userProperties:!0,selectHighlightColor:"red"});window.draw=a;m=new M({draw:a,buttons:[{on:"click",action:b,classes:["select-icon"]}]});u.once("load",()=>{u.resize(),u.addControl(m,"top-right"),a.set({type:"FeatureCollection",features:[{type:"Feature",properties:{},geometry:{coordinates:[[[51.03172414839912,35.920869678862005],[51.03172414839912,35.62049410212656],[51.461567534481134,35.62049410212656],[51.461567534481134,35.920869678862005],[51.03172414839912,35.920869678862005]]],type:"Polygon"}},{type:"Feature",properties:{},geometry:{coordinates:[[51.6404618916944,35.57806814108352],[51.82929482430853,35.860482623322696]],type:"LineString"}},{type:"Feature",properties:{},geometry:{coordinates:[51.40193608207707,35.45267939803206],type:"Point"}}]}),u.on("draw.update",function(e){console.log("\u{1F680} ~ file: index.js ~ line 158 ~ e",e)})});
